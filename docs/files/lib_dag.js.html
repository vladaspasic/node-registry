<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Node-registry by vladaspasic</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="stylesheet" href="">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="stylesheet" href="../assets/vendor/bootstrap/css/bootstrap.css">
    <link rel="stylesheet" href="../assets/css/custom.css">
    <link rel="stylesheet" href="../assets/css/lucid.css">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
</head>
<body class="yui3-skin-sam">
<div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
        <a href="http://vladaspasic.github.io/node-registry">
            <h1 class="brand" style="padding: 10px 16px 10px; height: 20px; line-height: 20px; margin-left: 0;">
            
                Node Registry
            </h1>    
        </a>
    <div class="nav">
            <li class="divider-vertical"></li>
            <li>
                <p class="navbar-text">
                    Node Registry API: lightweight IoC for Node applications
                </p>
            </li>
        </div>
        <form class="navbar-form pull-right" style="line-height: 40px; height: 40px;">
            <input style="margin-top: 0;" type="text" class="search-query" placeholder="Search for classes/modules..." data-obj='["classes/Container", "classes/DAG", "classes/EventEmitter", "classes/Holder", "classes/Module", "classes/Object", "classes/OrederedConfiguration", "classes/Registry", "classes/Server"]'>
        </form>
    </div>
</div>
<div class="container">
    <div class="row">
        <div class="span3" id='sidebar-left'>
            <div class='repo-info'>
                

                <p>Version: 0.1.8</p>

                <p class="view"><a href="https://github.com/vladaspasic/node-registry">View the Project on GitHub <small>vladaspasic/node-registry</small></a></p>


                <ul>
                  <li><a href="https://github.com/vladaspasic/node-registry/zipball/master">Download <strong>ZIP File</strong></a></li>
                  <li><a href="https://github.com/vladaspasic/node-registry/tarball/master">Download <strong>TAR Ball</strong></a></li>
                  <li><a href="https://github.com/vladaspasic/node-registry">View On <strong>GitHub</strong></a></li>
                </ul>
            </div>

           <div>
    <div id="sidebar">
    <div id="classes">
        <ul id="api-classes" class="nav nav-list">
        	<li class="nav-header">Classes</li>
            
                <li><a href="../classes/Container.html">Container</a></li>
            
                <li><a href="../classes/DAG.html">DAG</a></li>
            
                <li><a href="../classes/EventEmitter.html">EventEmitter</a></li>
            
                <li><a href="../classes/Holder.html">Holder</a></li>
            
                <li><a href="../classes/Module.html">Module</a></li>
            
                <li><a href="../classes/Object.html">Object</a></li>
            
                <li><a href="../classes/OrederedConfiguration.html">OrederedConfiguration</a></li>
            
                <li><a href="../classes/Registry.html">Registry</a></li>
            
                <li><a href="../classes/Server.html">Server</a></li>
            
            <li class="divider"></li>
        </ul>
    </div>
    </div>
</div>

        </div>
        <div class="span9 offset3">
                <form id="options-form" class="form-inline pull-right">
        Show:
        <label for="api-show-inherited" class="checkbox">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected" class="checkbox">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private" class="checkbox">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated" class="checkbox">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </form>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <div class="page-header">
    <h1>lib/dag.js <small>File</small></h1>
</div>

<div class="file">
    <pre class="prettyprint linenums">
/*jslint node: true */
&quot;use strict&quot;;

/**
 * DAG stands for Directed acyclic graph.
 * It is used to build a graph of dependencies checking that there isn&#x27;t circular
 * dependencies. p.e Registering initializers with a certain precedence order.
 * 
 * @class DAG
 * @constructor
 */
function DAG() {
  this.names = [];
  this.vertices = {};
}

/**
 * Adds a vertex entry to the graph unless it is already added.
 * @private
 * @method add
 * @param {String} name The name of the vertex to add
 * @return vertex
 */
DAG.prototype.add = function(name) {
  if (!name) {
    return;
  }
  if (this.vertices.hasOwnProperty(name)) {
    return this.vertices[name];
  }
  var vertex = {
    name: name,
    incoming: {},
    incomingNames: [],
    hasOutgoing: false,
    value: null
  };
  this.vertices[name] = vertex;
  this.names.push(name);
  return vertex;
};

/**
 * Adds a vertex to the graph and sets its value.
 * @private
 * @method map
 * @param {String} name The name of the vertex.
 * @param value The value to put in the vertex.
 * @return 
 */
DAG.prototype.map = function(name, value) {
  this.add(name).value = value;
};

/**
 * Connects the vertices with the given names, adding them to the graph if
 * necesary, only if this does not produce is any circular dependency.
 * @private
 * @method addEdge
 * @param {String} fromName The name the vertex where the edge starts.
 * @param {String} toName The name the vertex where the edge ends.
 * @return 
 */
DAG.prototype.addEdge = function(fromName, toName) {
  if (!fromName || !toName || fromName === toName) {
    return;
  }
  var from = this.add(fromName),
    to = this.add(toName);
  if (to.incoming.hasOwnProperty(fromName)) {
    return;
  }

  /**
   * Description
   * @method checkCycle
   * @param {} vertex
   * @param {} path
   * @return 
   */
  function checkCycle(vertex, path) {
    if (vertex.name === toName) {
      throw new Error(&quot;cycle detected: &quot; + toName + &quot; &lt;- &quot; + path.join(&quot; &lt;- &quot;));
    }
  }
  visit(from, checkCycle);
  from.hasOutgoing = true;
  to.incoming[fromName] = from;
  to.incomingNames.push(fromName);
};

/**
 * Visits all the vertex of the graph calling the given function with each one,
 * ensuring that the vertices are visited respecting their precedence.
 * @method topsort
 * @param {Function} fn The function to be invoked on each vertex.
 * @return 
 */
DAG.prototype.topsort = function(fn) {
  var visited = {};
  var vertices = this.vertices;
  var names = this.names;
  var len = names.length;
  var i, vertex;

  for (i = 0; i &lt; len; i++) {
    vertex = vertices[names[i]];
    if (!vertex.hasOutgoing) {
      visit(vertex, fn, visited);
    }
  }
};

/**
 * Adds a vertex with the given name and value to the graph and joins it with the
 * vertices referenced in _before_ and _after_. If there isn&#x27;t vertices with those
 * names, they are added too.
 * If either _before_ or _after_ are falsy/empty, the added vertex will not have
 * an incoming/outgoing edge.
 *                      which this vertex must be visited.
 *                      which this vertex must be visited.
 * @method addEdges
 * @param {String} name The name of the vertex to be added.
 * @param value The value of that vertex.
 * @param before An string or array of strings with the names of the vertices before
 * @param after An string or array of strings with the names of the vertex after
 * @return 
 */
DAG.prototype.addEdges = function(name, value, before, after) {
  var i;
  this.map(name, value);
  if (before) {
    if (typeof before === &#x27;string&#x27;) {
      this.addEdge(name, before);
    } else {
      for (i = 0; i &lt; before.length; i++) {
        this.addEdge(name, before[i]);
      }
    }
  }
  if (after) {
    if (typeof after === &#x27;string&#x27;) {
      this.addEdge(after, name);
    } else {
      for (i = 0; i &lt; after.length; i++) {
        this.addEdge(after[i], name);
      }
    }
  }
};

/**
 * Description
 * @method visit
 * @param {} vertex
 * @param {} fn
 * @param {} visited
 * @param {} path
 * @return 
 */
function visit(vertex, fn, visited, path) {
  var name = vertex.name;
  var vertices = vertex.incoming;
  var names = vertex.incomingNames;
  var len = names.length;
  var i;

  if (!visited) {
    visited = {};
  }
  if (!path) {
    path = [];
  }
  if (visited.hasOwnProperty(name)) {
    return;
  }
  path.push(name);
  visited[name] = true;
  for (i = 0; i &lt; len; i++) {
    visit(vertices[names[i]], fn, visited, path);
  }
  fn(vertex, path);
  path.pop();
}

module.exports = DAG;
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/jquery/jquery-1.8.2.min.js"></script>
<script src="../assets/vendor/bootstrap/js/bootstrap.js"></script>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script src="../assets/js/yuidoc-bootstrap.js"></script>
<script src="javascripts/scale.fix.js"></script>

<script>prettyPrint();</script>
<script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
    try {
        var pageTracker = _gat._getTracker("UA-57430955-1");
        pageTracker._trackPageview();
    } catch(err) {}
</script>
</body>
</html>
